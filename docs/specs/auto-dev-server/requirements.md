# 自动化开发服务器启动 需求文档

## 需求概述

**背景**: 开发全栈应用时，需要同时启动前端和后端服务，手动操作繁琐且容易忘记。

**目标**: 创建一个自动化技能，实现前端项目启动时自动同步启动后端服务的功能。

**范围**: 开发环境下的前后端服务自动启动、管理和联动控制。

## 功能需求

### 1. 启动事件检测

**需求 ID**: AUTO-SERVER-001  
**需求描述**: 技能能够检测前端项目的启动事件（如 npm start、yarn dev 等命令）

**验收标准**:
1. WHEN 执行前端启动命令（如 `npm run dev`）THEN 技能能识别此事件
2. WHEN 使用不同的包管理器（npm/yarn/pnpm）THEN 都能正确识别
3. WHEN 使用不同的构建工具（Vite/Webpack/CRA）THEN 都能正确识别

### 2. 后端服务自动启动

**需求 ID**: AUTO-SERVER-002  
**需求描述**: 在前端启动成功后，自动触发后端服务的启动流程

**验收标准**:
1. WHEN 前端服务成功启动并监听端口 THEN 后端服务自动开始启动
2. WHEN 后端服务成功启动 THEN 在终端显示成功提示
3. WHEN 后端服务启动失败 THEN 显示错误信息

### 3. 配置支持

**需求 ID**: AUTO-SERVER-003  
**需求描述**: 支持配置后端服务的启动命令、工作目录和环境变量

**验收标准**:
1. WHEN 配置文件存在 THEN 技能读取并使用配置
2. WHEN 配置文件不存在 THEN 使用默认配置
3. WHEN 修改配置 THEN 下次启动时生效

### 4. 联动控制

**需求 ID**: AUTO-SERVER-004  
**需求描述**: 实现前后端服务的联动控制，包括同时启动、同时停止和状态同步

**验收标准**:
1. WHEN 手动停止技能 THEN 前后端服务同时停止
2. WHEN 前端服务意外终止 THEN 后端服务自动安全关闭
3. WHEN 后端服务意外终止 THEN 前端继续运行但显示警告

### 5. 日志输出

**需求 ID**: AUTO-SERVER-005  
**需求描述**: 提供清晰的日志输出，分别显示前端和后端服务的运行状态和错误信息

**验收标准**:
1. WHEN 服务启动 THEN 分别显示前端和后端的启动日志
2. WHEN 服务输出日志 THEN 区分前后端来源（带标签）
3. WHEN 发生错误 THEN 高亮显示错误信息

### 6. 自动安全关闭

**需求 ID**: AUTO-SERVER-006  
**需求描述**: 确保在前端服务终止时，后端服务能够自动安全关闭

**验收标准**:
1. WHEN 前端进程退出 THEN 后端进程也被正确终止
2. WHEN 技能收到 SIGINT/SIGTERM 信号 THEN 优雅关闭所有服务
3. WHEN 服务关闭后 THEN 清理临时文件和资源

### 7. 环境兼容性

**需求 ID**: AUTO-SERVER-007  
**需求描述**: 支持在开发环境下稳定运行，兼容主流的前端构建工具和后端运行环境

**验收标准**:
1. WHEN 使用 Vite THEN 正常工作
2. WHEN 使用 Webpack/CRA THEN 正常工作
3. WHEN 使用 Node.js 后端 THEN 正常工作
4. WHEN 在 Windows/Mac/Linux 上运行 THEN 都能正常工作

### 8. 错误处理

**需求 ID**: AUTO-SERVER-008  
**需求描述**: 实现错误处理机制，当后端服务启动失败时能及时通知用户并提供排查建议

**验收标准**:
1. WHEN 后端服务启动失败 THEN 显示清晰的错误信息
2. WHEN 端口被占用 THEN 提示端口冲突并建议解决方案
3. WHEN 依赖缺失 THEN 提示安装依赖的命令
4. WHEN 配置错误 THEN 提示检查配置文件

## 非功能需求

### 1. 性能
- 技能启动延迟 < 1秒
- 前后端启动时间差 < 2秒

### 2. 可靠性
- 意外重启后能正确恢复状态
- 日志输出不丢失

### 3. 易用性
- 配置简单明了
- 日志清晰易读
- 错误提示友好

## 依赖关系

- 前端项目已存在且可正常启动
- 后端项目已存在且可正常启动
- Node.js 环境已安装
- 项目根目录有 package.json
