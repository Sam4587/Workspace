# 质量评估

## 概述

质量评估模块是 AI 内容创作系统的重要组成部分，负责对 AI 生成的内容进行自动化质量评分，并提供优化建议。质量评估基于多个维度，包括内容完整性、语言流畅度、观点清晰度、吸引力和规范性等，帮助用户快速了解内容质量，有针对性地改进内容。

## 评估维度

### 1. 内容完整性 (30%)

**评估要点**:
- 是否包含必要的结构元素
- 内容是否充实
- 逻辑是否完整

**评分标准**:

| 分数 | 说明 |
|------|------|
| 25-30 | 结构完整，内容充实 |
| 20-24 | 结构基本完整，内容较充实 |
| 15-19 | 结构不完整，内容单薄 |
| 0-14 | 缺少关键结构 |

**检测逻辑**:
```javascript
function checkCompleteness(content, type) {
  let score = 0;

  // 检查引言
  if (hasIntroduction(content)) score += 10;

  // 检查正文
  if (hasBody(content)) score += 10;

  // 检查结论
  if (hasConclusion(content)) score += 10;

  return score;
}
```

### 2. 语言流畅度 (25%)

**评估要点**:
- 语言是否通顺
- 是否存在语法错误
- 用词是否准确
- 句子结构是否合理

**评分标准**:

| 分数 | 说明 |
|------|------|
| 20-25 | 语言流畅，无语法错误 |
| 15-19 | 语言较流畅，少量语法问题 |
| 10-14 | 语言不够流畅，存在语法错误 |
| 0-9 | 语言不通顺，大量语法错误 |

**检测逻辑**:
```javascript
function checkFluency(content) {
  let score = 25;

  // 检查句子长度
  const sentences = content.split('。');
  const avgSentenceLength = sentences.reduce((sum, s) => sum + s.length, 0) / sentences.length;
  if (avgSentenceLength < 5 || avgSentenceLength > 50) score -= 5;

  // 检查重复词
  const repeatedWords = findRepeatedWords(content);
  score -= repeatedWords.length * 2;

  // 检查标点符号使用
  if (!hasProperPunctuation(content)) score -= 5;

  return Math.max(0, score);
}
```

### 3. 观点清晰度 (20%)

**评估要点**:
- 观点是否明确
- 逻辑是否清晰
- 论证是否充分
- 结论是否有力

**评分标准**:

| 分数 | 说明 |
|------|------|
| 15-20 | 观点明确，逻辑清晰，论证充分 |
| 10-14 | 观点较明确，逻辑较清晰 |
| 5-9 | 观点不够明确，逻辑混乱 |
| 0-4 | 观点模糊，逻辑不清 |

**检测逻辑**:
```javascript
function checkClarity(content) {
  let score = 0;

  // 检查是否有明确观点
  if (hasClearViewpoint(content)) score += 10;

  // 检查逻辑流
  if (hasLogicalFlow(content)) score += 10;

  return score;
}
```

### 4. 吸引力 (15%)

**评估要点**:
- 标题是否吸引人
- 开头是否引人入胜
- 内容是否有趣
- 是否有互动性

**评分标准**:

| 分数 | 说明 |
|------|------|
| 12-15 | 标题和开头非常有吸引力 |
| 8-11 | 标题和开头较有吸引力 |
| 4-7 | 标题和开头一般 |
| 0-3 | 缺乏吸引力 |

**检测逻辑**:
```javascript
function checkAttractiveness(content, title) {
  let score = 0;

  // 检查标题
  if (hasCatchyTitle(title)) score += 5;

  // 检查开头
  if (hasEngagingIntro(content)) score += 5;

  // 检查互动性
  if (hasInteractionElements(content)) score += 5;

  return score;
}
```

### 5. 规范性 (10%)

**评估要点**:
- 是否符合平台规范
- 是否包含违规内容
- 格式是否正确

**评分标准**:

| 分数 | 说明 |
|------|------|
| 8-10 | 完全符合规范 |
| 5-7 | 基本符合规范 |
| 0-4 | 存在违规内容 |

**检测逻辑**:
```javascript
function checkCompliance(content) {
  let score = 10;

  // 检查敏感词
  if (containsSensitiveWords(content)) score -= 5;

  // 检查格式
  if (!hasProperFormat(content)) score -= 3;

  // 检查长度
  if (isTooShort(content) || isTooLong(content)) score -= 2;

  return Math.max(0, score);
}
```

## 综合评分

### 评分计算

```javascript
function calculateOverallScore(assessments) {
  const weights = {
    completeness: 0.30,
    fluency: 0.25,
    clarity: 0.20,
    attractiveness: 0.15,
    compliance: 0.10
  };

  let totalScore = 0;

  for (const [dimension, score] of Object.entries(assessments)) {
    totalScore += score * weights[dimension];
  }

  return Math.round(totalScore);
}
```

### 评分等级

| 等级 | 分数范围 | 说明 |
|------|----------|------|
| 优秀 | 90-100 | 内容质量很高，可以直接发布 |
| 良好 | 75-89 | 内容质量较好，稍作修改即可发布 |
| 一般 | 60-74 | 内容质量一般，需要较多修改 |
| 较差 | 低于 60 | 内容质量较差，需要大幅修改 |

## 优化建议生成

### 建议类型

#### 1. 内容补充建议

```
- 建议增加更多论据支撑观点
- 可以添加具体案例增强说服力
- 建议补充数据支持
```

#### 2. 结构优化建议

```
- 建议调整段落顺序，使逻辑更清晰
- 引言部分可以更精炼
- 结论部分可以更有力
```

#### 3. 语言改进建议

```
- 部分句子过长，建议拆分
- 存在重复表达，建议修改
- 用词可以更精准
```

#### 4. 吸引力提升建议

```
- 标题可以更具吸引力
- 开头可以更有冲击力
- 建议增加互动性问题
```

### 建议生成逻辑

```javascript
function generateSuggestions(content, assessments, score) {
  const suggestions = [];

  // 根据评分生成建议
  if (assessments.completeness < 20) {
    suggestions.push('建议补充内容，增加论据和案例');
  }

  if (assessments.fluency < 15) {
    suggestions.push('建议修改语言，使其更流畅');
  }

  if (assessments.clarity < 10) {
    suggestions.push('建议明确观点，优化逻辑结构');
  }

  if (assessments.attractiveness < 8) {
    suggestions.push('建议优化标题和开头，提升吸引力');
  }

  if (assessments.compliance < 8) {
    suggestions.push('建议修改违规内容，确保符合规范');
  }

  return suggestions;
}
```

## 辅助指标

### 字数统计

```javascript
function countWords(content) {
  // 移除标点符号和空格
  const cleanContent = content.replace(/[^\u4e00-\u9fa5a-zA-Z0-9]/g, '');
  return cleanContent.length;
}
```

### 阅读时间估算

```javascript
function estimateReadingTime(content) {
  const wordCount = countWords(content);
  // 中文平均阅读速度：300字/分钟
  return Math.ceil(wordCount / 300);
}
```

### 关键词密度

```javascript
function calculateKeywordDensity(content, keywords) {
  const wordCount = countWords(content);
  const keywordCount = keywords.reduce((sum, keyword) => {
    const regex = new RegExp(keyword, 'gi');
    const matches = content.match(regex);
    return sum + (matches ? matches.length : 0);
  }, 0);

  return (keywordCount / wordCount) * 100;
}
```

## API 接口

### 评估内容质量

```
POST /api/content/assess
```

**请求体**:
```json
{
  "content": "随着人工智能技术的快速发展...",
  "type": "article",
  "title": "人工智能在医疗领域的应用"
}
```

**响应**:
```json
{
  "success": true,
  "data": {
    "overallScore": 85,
    "assessments": {
      "completeness": 25,
      "fluency": 22,
      "clarity": 18,
      "attractiveness": 12,
      "compliance": 8
    },
    "suggestions": [
      "可以增加具体案例增强说服力",
      "建议补充数据支持"
    ],
    "metrics": {
      "wordCount": 1200,
      "readingTime": 4,
      "keywordDensity": 2.5
    }
  }
}
```

## 质量提升策略

### 1. 多次生成对比

对于重要内容，生成多个版本，选择质量最高的。

### 2. 人工编辑优化

根据质量评估结果和优化建议，有针对性地修改内容。

### 3. 持续学习

分析高质量内容的特征，优化 AI 提示词。

### 4. 用户反馈收集

收集用户对内容的反馈，不断优化评估算法。

## 技术实现

### 质量评估服务

```javascript
class QualityAssessment {
  async assess(content, type, title) {
    const assessments = {
      completeness: this.checkCompleteness(content, type),
      fluency: this.checkFluency(content),
      clarity: this.checkClarity(content),
      attractiveness: this.checkAttractiveness(content, title),
      compliance: this.checkCompliance(content)
    };

    const overallScore = this.calculateOverallScore(assessments);
    const suggestions = this.generateSuggestions(content, assessments, overallScore);

    const metrics = {
      wordCount: this.countWords(content),
      readingTime: this.estimateReadingTime(content),
      keywordDensity: this.calculateKeywordDensity(content)
    };

    return {
      overallScore,
      assessments,
      suggestions,
      metrics
    };
  }
}

module.exports = new QualityAssessment();
```

### 集成到内容生成流程

```javascript
// 生成内容后立即评估
const generatedContent = await multiAIService.generateContent(prompt, options);
const assessment = await qualityAssessment.assess(
  generatedContent.content,
  options.type,
  options.title
);

// 保存评估结果
const content = new Content({
  ...generatedContent,
  quality: assessment.overallScore,
  suggestions: assessment.suggestions,
  wordCount: assessment.metrics.wordCount,
  readingTime: assessment.metrics.readingTime
});

await content.save();
```

## 扩展规划

### 短期

- [ ] 优化评估算法准确率
- [ ] 增加更多评估维度
- [ ] 改进优化建议质量

### 中期

- [ ] 支持自定义评估标准
- [ ] 实现质量趋势追踪
- [ ] 添加风格一致性评估

### 长期

- [ ] 构建质量预测模型
- [ ] 实现自动内容优化
- [ ] 支持多语言质量评估
