# AI Content Flow 业务功能优化实施计划

## 概述
本文档记录 AI Content Flow 项目业务功能优化的详细实施计划，重点解决热点内容与内容创作模块的关联问题，以及其他业务逻辑问题。

## 阶段一：项目现状评估

### 1.1 项目全流程测试

| 任务 | 状态 | 预计工时 | 负责人 | 完成时间 |
|------|------|----------|--------|----------|
| 前端功能完整性测试 | pending | 1h | AI助手 | - |
| 后端 API 功能测试 | pending | 1h | AI助手 | - |
| 热点模块功能验证 | pending | 30min | AI助手 | - |
| 内容创作模块验证 | pending | 30min | AI助手 | - |
| 发布中心功能验证 | pending | 30min | AI助手 | - |
| 数据分析模块验证 | pending | 30min | AI助手 | - |

### 1.2 业务链条完整性检查

| 检查项 | 状态 | 说明 |
|--------|------|------|
| 热点 → 内容创作关联 | in_progress | 见 findings.md |
| 内容创作 → 发布关联 | pending | - |
| 发布 → 数据分析关联 | pending | - |
| 全链路数据追踪 | pending | - |

---

## 阶段二：问题识别与分析

### 2.1 已识别问题清单

| ID | 问题描述 | 严重程度 | 影响范围 | 优先级 |
|----|----------|----------|----------|--------|
| PROB-001 | 热点内容与内容创作关联不完整 | 高 | 核心业务流程 | P0 |
| PROB-002 | 内容保存机制不完整 | 中 | 内容创作模块 | P1 |
| PROB-003 | 发布中心与 mcp-publish-platform 对接不完整 | 中 | 发布模块 | P1 |
| PROB-004 | 数据分析数据来源不完整 | 低 | 数据分析模块 | P2 |

### 2.2 问题详情

#### PROB-001: 热点内容与内容创作关联
- **表现形式**: 
  - HotTopics 页面有跳转到 ContentCreation 的功能 (`handleGenerateContent`)
  - ContentCreation 接收 topic 数据并自动填充表单
  - 但生成内容后没有保存热点关联关系
  - 缺少从内容回溯到热点的功能
- **影响**: 无法追踪内容来源，影响数据分析准确性
- **优先级**: 高

#### PROB-002: 内容保存机制不完整
- **表现形式**: 
  - 生成内容后没有统一的保存流程
  - 缺少内容版本管理
  - 缺少内容状态流转（草稿 → 待发布 → 已发布）
- **影响**: 内容管理混乱，用户体验差
- **优先级**: 中

#### PROB-003: 发布中心对接不完整
- **表现形式**: 
  - PublishCenter 页面存在但与 mcp-publish-platform 对接不完整
  - 缺少平台登录状态管理
  - 缺少发布进度追踪
- **影响**: 发布功能可用性低
- **优先级**: 中

#### PROB-004: 数据分析来源不完整
- **表现形式**: 
  - 分析数据主要是模拟数据
  - 缺少真实的内容发布数据回流
  - 缺少用户行为数据采集
- **影响**: 数据分析可信度低
- **优先级**: 低

---

## 阶段三：优化方案制定

### 3.1 PROB-001 解决方案：热点-内容关联优化

#### 技术方案
1. **数据模型增强**
   - 在 Content 模型中添加 `hotTopicId` 字段
   - 添加关联索引
   - 支持双向查询

2. **前端流程优化**
   - HotTopics 页面：点击"生成内容"传递完整热点数据
   - ContentCreation 页面：保存时关联热点 ID
   - 新增内容详情页：显示来源热点信息

3. **后端 API 增强**
   - 新增 `GET /api/contents?hotTopicId=xxx` 按热点查询内容
   - 新增 `GET /api/hot-topics/:id/contents` 获取热点关联内容
   - 内容创建时自动关联热点信息

#### 验收标准
- [ ] 从热点生成的内容能在数据库中找到关联关系
- [ ] 内容详情页能显示来源热点信息
- [ ] 热点页面能查看基于该热点生成的内容列表

### 3.2 PROB-002 解决方案：内容保存机制完善

#### 技术方案
1. **内容状态管理**
   - 定义完整的状态机：草稿 → 待审核 → 待发布 → 已发布 → 已下线
   - 实现状态变更 API
   - 添加状态变更历史记录

2. **内容版本管理**
   - 每次编辑创建新版本
   - 支持版本对比和回滚
   - 记录版本变更者和时间

3. **保存流程优化**
   - 自动保存草稿（每 30 秒）
   - 手动保存按钮
   - 保存成功反馈

#### 验收标准
- [ ] 内容状态能正常流转
- [ ] 自动保存功能正常工作
- [ ] 版本历史可查

### 3.3 PROB-003 解决方案：发布中心对接

#### 技术方案
1. **mcp-publish-platform API 集成**
   - 完善平台登录状态查询
   - 实现发布任务提交
   - 实现发布进度轮询

2. **前端 UI 优化**
   - 平台登录状态展示
   - 发布进度可视化
   - 发布历史记录

#### 验收标准
- [ ] 能查看各平台登录状态
- [ ] 能提交发布任务并查看进度
- [ ] 能查看发布历史

### 3.4 PROB-004 解决方案：数据分析完善

#### 技术方案
1. **数据采集增强**
   - 内容发布后自动记录发布数据
   - 添加内容浏览/互动数据采集
   - 实现数据定时同步

2. **分析功能完善**
   - 基于真实数据的统计
   - 热点-内容转化漏斗分析
   - 发布效果追踪

#### 验收标准
- [ ] 发布数据能正确回流到分析模块
- [ ] 分析图表基于真实数据
- [ ] 能查看热点内容转化效果

---

## 阶段四：开发任务规划

### 4.1 任务分解（按优先级）

#### P0 任务（必须完成）

| 任务 ID | 任务描述 | 依赖 | 预计工时 | 负责人 |
|---------|----------|------|----------|--------|
| TASK-001 | 后端：Content 模型添加 hotTopicId 字段 | 无 | 30min | AI助手 |
| TASK-002 | 后端：新增热点-内容关联查询 API | TASK-001 | 30min | AI助手 |
| TASK-003 | 前端：ContentCreation 保存热点关联 | 无 | 30min | AI助手 |
| TASK-004 | 前端：HotTopics 查看关联内容 | TASK-002 | 45min | AI助手 |

#### P1 任务（重要）

| 任务 ID | 任务描述 | 依赖 | 预计工时 | 负责人 |
|---------|----------|------|----------|--------|
| TASK-005 | 后端：内容状态机实现 | 无 | 1h | AI助手 |
| TASK-006 | 前端：内容状态 UI | TASK-005 | 45min | AI助手 |
| TASK-007 | 前端：自动保存功能 | 无 | 1h | AI助手 |
| TASK-008 | 发布中心：mcp-publish-platform 对接 | 无 | 2h | AI助手 |

#### P2 任务（可选）

| 任务 ID | 任务描述 | 依赖 | 预计工时 | 负责人 |
|---------|----------|------|----------|--------|
| TASK-009 | 内容版本管理 | TASK-005 | 2h | AI助手 |
| TASK-010 | 数据分析数据回流 | TASK-008 | 2h | AI助手 |
| TASK-011 | 热点-内容转化分析 | TASK-010 | 1.5h | AI助手 |

### 4.2 任务依赖关系图

```
TASK-001 ──┐
           ├─> TASK-002 ──> TASK-004
TASK-003 ──┘

TASK-005 ──> TASK-006
         └─> TASK-009

TASK-008 ──> TASK-010 ──> TASK-011

TASK-007 (独立)
```

### 4.3 开发顺序建议

**第一阶段（P0，核心关联）**
1. TASK-001 → TASK-002 → TASK-004
2. TASK-003（可并行）

**第二阶段（P1，内容管理）**
1. TASK-005 → TASK-006
2. TASK-007（可并行）
3. TASK-008

**第三阶段（P2，增强功能）**
1. TASK-009
2. TASK-010 → TASK-011

---

## 阶段五：实施与验证

### 5.1 测试计划

#### 单元测试
- 每个 API 端点的单元测试
- 数据模型验证测试

#### 集成测试
- 热点→内容创作→发布完整流程测试
- 数据回流测试

#### 用户验收测试
- 核心功能走查
- 用户体验验证

### 5.2 里程碑

| 里程碑 | 目标 | 预计完成时间 | 验收标准 |
|--------|------|--------------|----------|
| M1 | P0 任务完成 | 2026-02-19 | 热点-内容关联功能完整可用 |
| M2 | P1 任务完成 | 2026-02-20 | 内容管理和发布功能完善 |
| M3 | 全流程测试通过 | 2026-02-21 | 所有验收测试通过 |

---

## 风险与应对

| 风险 | 可能性 | 影响 | 缓解措施 |
|------|--------|------|----------|
| mcp-publish-platform API 变更 | 中 | 高 | 提前与发布工具团队确认 API 规范 |
| 数据库迁移影响现有数据 | 低 | 中 | 先备份数据，写迁移脚本 |
| 开发进度延期 | 中 | 中 | 优先保证 P0 任务，P1/P2 可延后 |

---

## 参考资料

- [架构重组设计文档](docs/plans/2026-02-18-architecture-reorganization-design.md)
- [mcp-publish-platform 设计文档](docs/specs/mcp-publish-platform/design.md)
- [项目开发计划](docs/DEVELOPMENT_PLAN.md)

---

*最后更新: 2026-02-18*
